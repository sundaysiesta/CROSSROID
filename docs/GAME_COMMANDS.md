# ゲーム機能詳細

## 📋 目次

1. [決闘（/duel）](#決闘duel)
2. [ロシアンルーレット（/duel_russian）](#ロシアンルーレットduel_russian)
3. [じゃんけん（/janken）](#じゃんけんjanken)
4. [麻雀（/mahjong_create）](#麻雀mahjong_create)
5. [ランキング](#ランキング)

---

## 決闘（/duel）

### 概要
他のユーザーと決闘してロメコインを賭けます。

### コマンド
```
/duel [対戦相手] [bet]
```

### オプション
- `対戦相手` (任意): 対戦相手（未指定時は誰でも挑戦可能）
- `bet` (任意): 賭けるロメコインの量（デフォルト: 100）

### ルール
1. **対戦相手が指定されている場合**:
   - 指定されたユーザーに挑戦を送信
   - 対戦相手が承認すると決闘が開始
   - 勝者が賭け金の全額を獲得
   - 敗者は賭け金を失う

2. **対戦相手が指定されていない場合**:
   - 募集メッセージが送信される
   - 誰でも挑戦可能
   - 最初に承認したユーザーと対戦

### 勝敗判定
- ランダムで決定（50%の確率）

### 制限
- 世代ロール必須
- 残高が不足している場合はエラー
- 自分自身とは対戦不可
- Botとは対戦不可

### ランキング
- `/duel_ranking`でランキングを確認可能
- 勝利数、勝率、獲得ロメコインを表示

---

## ロシアンルーレット（/duel_russian）

### 概要
ロシアンルーレットで対戦してロメコインを賭けます。

### コマンド
```
/duel_russian [対戦相手] [bet]
```

### オプション
- `対戦相手` (任意): 対戦相手（未指定時は誰でも挑戦可能）
- `bet` (任意): 賭けるロメコインの量（デフォルト: 100）

### ルール
1. **対戦相手が指定されている場合**:
   - 指定されたユーザーに挑戦を送信
   - 対戦相手が承認するとロシアンルーレットが開始
   - 6発の弾倉から1発が当たる確率で勝負
   - 勝者が賭け金の全額を獲得
   - 敗者は賭け金を失う

2. **対戦相手が指定されていない場合**:
   - 募集メッセージが送信される
   - 誰でも挑戦可能
   - 最初に承認したユーザーと対戦

### 勝敗判定
- 6分の1の確率で当たる
- 当たった方が負け

### 制限
- 世代ロール必須
- 残高が不足している場合はエラー
- 自分自身とは対戦不可
- Botとは対戦不可

---

## じゃんけん（/janken）

### 概要
じゃんけんで対戦してロメコインを賭けます。

### コマンド
```
/janken [opponent] [bet]
```

### オプション
- `opponent` (任意): 対戦相手（クロスロイドを指定するとボット対戦、空白だと対戦募集）
- `bet` (任意): 賭けるロメコインの量（100以上、デフォルト: 100）

### ルール
1. **対戦相手が指定されている場合**:
   - 指定されたユーザーに挑戦を送信
   - 対戦相手が承認するとじゃんけんが開始
   - 勝者が賭け金の全額を獲得
   - 敗者は賭け金を失う
   - あいこの場合は返金

2. **対戦相手が「クロスロイド」の場合**:
   - ボットと対戦
   - ボットの手はランダム

3. **対戦相手が指定されていない場合**:
   - 募集メッセージが送信される
   - 誰でも挑戦可能
   - 最初に承認したユーザーと対戦

### 勝敗判定
- 通常のじゃんけんのルール（グー、チョキ、パー）
- あいこの場合は返金

### 制限
- 世代ロール必須
- 残高が不足している場合はエラー
- 最低賭け金: 100コイン
- 自分自身とは対戦不可（ボット対戦を除く）

### ランキング
- `/janken_ranking`でランキングを確認可能
- 勝利数、勝率、獲得ロメコインを表示

---

## 麻雀（/mahjong_create）

### 概要
雀魂を使った賭け麻雀のテーブルを作成します。

### コマンド
```
/mahjong_create [rate] [player1] [player2] [player3]
```

### オプション
- `rate` (必須): レート（1点あたりのロメコイン、0.1〜1）
- `player1` (必須): 参加メンバー1（部屋主）
- `player2` (必須): 参加メンバー2
- `player3` (任意): 参加メンバー3（四麻の場合のみ必要）

### ルール
1. **サンマ（3人）**:
   - `player3`を指定しない場合
   - 3人で対戦

2. **四麻（4人）**:
   - `player3`を指定した場合
   - 4人で対戦

3. **点数計算**:
   - 点数にレートを掛けた金額がロメコインで決済される
   - プラス点数のプレイヤーは獲得
   - マイナス点数のプレイヤーは支払い

### 試合結果の入力
**コマンド**: `/mahjong_result`

**オプション**:
- `table_id` (必須): テーブルID（試合開始時に表示されます）
- `player1_score` (必須): 部屋主の点数
- `player2_score` (必須): プレイヤー1の点数
- `player3_score` (必須): プレイヤー2の点数
- `player4_score` (任意): プレイヤー3の点数（四麻の場合のみ必要）

### 試合記録の修正
**コマンド**: `/mahjong_edit`（部屋主のみ）

**オプション**:
- `table_id` (必須): 修正するテーブルID
- `player1_score` (必須): 部屋主の点数（修正後）
- `player2_score` (必須): プレイヤー1の点数（修正後）
- `player3_score` (必須): プレイヤー2の点数（修正後）
- `player4_score` (任意): プレイヤー3の点数（修正後、四麻の場合のみ必要）

### 制限
- 世代ロール必須
- レートは0.1以上1以下
- 部屋主のみが試合結果を入力・修正可能

### ランキング
- `/mahjong_ranking`でランキングを確認可能
- 勝利数、勝率、獲得ロメコイン、総試合数を表示

---

## ランキング

### 決闘ランキング
**コマンド**: `/duel_ranking`

**表示内容**:
- 勝利数
- 勝率
- 獲得ロメコイン

### じゃんけんランキング
**コマンド**: `/janken_ranking`

**表示内容**:
- 勝利数
- 勝率
- 獲得ロメコイン

### 麻雀ランキング
**コマンド**: `/mahjong_ranking`

**表示内容**:
- 勝利数
- 勝率
- 獲得ロメコイン
- 総試合数

---

## 関連ドキュメント

- [COMMANDS_OVERVIEW.md](./COMMANDS_OVERVIEW.md) - コマンド一覧
- [ROMECOIN_SYSTEM.md](./ROMECOIN_SYSTEM.md) - ロメコインシステムの詳細

