# 月間ランキング賞金システム

## 📋 概要

一カ月の間にどれくらい話したかのランキング（レベルランキング）で、上位10人にロメコインを配布します。

**注意:** 既にたくさん話している人が上位になるため、賞金額は控えめに設定し、富の集中を防ぎます。

---

## 💰 賞金額（月間、上位10人に配布）

| 順位 | 賞金額 | 根拠 |
|:---|:---|:---|
| **1位** | **15,000コイン** | 30位までの週間獲得量に相当。控えめな設定で富の集中を防止 |
| **2位** | **12,000コイン** | 30位までの週間獲得量の0.6-0.8倍 |
| **3位** | **10,000コイン** | 部活ランキング1位の賞金と同額 |
| **4位** | **8,000コイン** | 部活ランキング3位の賞金と同額 |
| **5位** | **6,000コイン** | 部活ランキング5位の賞金と同額 |
| **6位** | **5,000コイン** | 30位までの週間獲得量の0.25-0.33倍 |
| **7位** | **4,000コイン** | 30位までの週間獲得量の0.2-0.27倍 |
| **8位** | **3,000コイン** | 部活維持費と同額 |
| **9位** | **2,500コイン** | 控えめな報酬 |
| **10位** | **2,000コイン** | 控えめな報酬 |

**合計賞金額: 67,500コイン/月**

---

## 📊 実データベースとの比較

### 実際の獲得量（月間）
- **上位10人: 月間193,000-343,000コイン**
- **15位まで: 月間129,000-171,000コイン**
- **30位まで: 月間64,000-86,000コイン**

### 賞金額の妥当性
- **1位（15,000コイン）**: 30位までの週間獲得量に相当。控えめな設定で富の集中を防止
- **3位（10,000コイン）**: 部活ランキング1位と同額
- **10位（2,000コイン）**: 控えめな報酬で、過度な富の集中を防ぐ

---

## 🎯 賞金システムの効果

1. **控えめな報酬で富の集中を防止**
   - 既にたくさん話している人が上位になるため、賞金額は控えめ
   - 1位でも30位までの週間獲得量程度で、過度な富の集中を防ぐ

2. **継続的な活動のインセンティブ**
   - 月間で話した量に応じた報酬
   - 上位10人に入ることで、少しの追加ロメコインを獲得

3. **経済循環の促進**
   - 月1回の賞金配布によるロメコインの循環
   - 控えめな賞金額で、経済バランスを維持

---

## 💻 実装時の設定値

```javascript
const MONTHLY_RANKING_REWARDS = {
    // 月間ランキング上位10人の賞金（控えめな設定で富の集中を防止）
    rewards: {
        1: 15000,  // 1位の賞金（30位までの週間獲得量に相当）
        2: 12000,  // 2位の賞金
        3: 10000,  // 3位の賞金（部活ランキング1位と同額）
        4: 8000,   // 4位の賞金（部活ランキング3位と同額）
        5: 6000,   // 5位の賞金（部活ランキング5位と同額）
        6: 5000,   // 6位の賞金
        7: 4000,   // 7位の賞金
        8: 3000,   // 8位の賞金（部活維持費と同額）
        9: 2500,   // 9位の賞金
        10: 2000   // 10位の賞金
    },
    // 合計賞金額: 67,500コイン/月
    totalPerMonth: 67500
};
```

---

## 🔄 処理フロー

```
1. 月間ランキングの計算
   ├─ 各部活チャンネルのメッセージ数やアクティビティを集計
   └─ ランキング上位10人を決定

2. 上位10人のロメコイン残高を確認
   └─ 必要に応じて残高確認（基本的には問題なし）

3. 賞金の支払い
   └─ ランキング1-10位のユーザーに賞金を支払い

4. 通知
   └─ 賞金受取者への通知（必要に応じて）
```

---

## 🔌 API連携

### ロメコインの追加（賞金支払い）

```javascript
// POST /api/romecoin/:userId/add
// ヘッダー: x-api-token: {API_TOKEN}
// ボディ: { amount: number }
// レスポンス: { 
//   success: boolean,
//   userId: string,
//   added: number,
//   previousBalance: number,
//   newBalance: number
// }
```

**注意:** このエンドポイントはCROSSROID側に追加実装が必要です。

---

## 📝 実装時の注意点

1. **エラーハンドリング**
   - API呼び出し失敗時の処理
   - ネットワークエラー時のリトライ処理

2. **ログ記録**
   - 賞金支払いの記録
   - ランキング結果の記録

3. **通知機能**
   - 賞金受取者への通知
   - ランキング結果の公開

4. **パフォーマンス**
   - ランキング計算の最適化
   - 大量のユーザーがいる場合の処理時間を考慮

---

## 📞 連絡事項

- 実装時の質問や問題があれば、CROSSROID開発者に連絡
- API仕様の変更がある場合は、事前に確認すること
- テスト環境での動作確認を十分に行うこと

